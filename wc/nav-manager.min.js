"use strict";webui.define("app-nav-manager",{linkCss:!0,watchVisibility:!1,isInput:!1,preload:"webui-icon-search",nav:[],constructor:t=>{let link={name:"",icon:"",url:"",children:[]};t._navDetail=t.template.querySelector("span.detail"),t._navPreview=t.template.querySelector("app-nav-preview"),t._navName=t.template.querySelector('webui-input-text[label="Name"]'),t._navIcon=t.template.querySelector('webui-input-text[label="Icon"]'),t._btnAddFolder=t.template.querySelector('webui-button[label="Add Folder"]'),t._btnAddPage=t.template.querySelector('webui-button[label="Add Page"]'),t._btnDelete=t.template.querySelector('webui-button[label="Delete"]'),t._btnSave=t.template.querySelector('webui-button[label="Save"]'),t._btnCancel=t.template.querySelector('webui-button[label="Cancel"]'),t._iconSearch=t.template.querySelector("webui-icon-search"),t.dataset.subscribe="app-nav-routes:setNavRoutes",t._iconSearch.addEventListener("icon-update",(ev=>{t._navIcon.value=ev.detail,link.icon=ev.detail})),t._navPreview.addEventListener("nav-preview-click",(ev=>{ev.preventDefault(),ev.stopPropagation(),link=ev.detail,t._iconSearch.setIconFromCode(ev.detail.icon),t._navName.value=ev.detail.name})),t._navName.addEventListener("input",(ev=>{link.name=t._navName.value})),t._btnSave.addEventListener("click",(_=>{t.saveNavigation()})),t._btnCancel.addEventListener("click",(_=>{t.loadNavigation()})),t._btnDelete.addEventListener("click",(_=>{t.updateNav(),function checkChildren(list){for(let index=0;index<list.length;++index){if(link.id===list[index].id)return void list.splice(index,1);list[index].children&&checkChildren(list[index])}}(t.nav),t._navPreview.buildNav(t.nav,!0)})),t._btnAddFolder.addEventListener("click",(_=>{t.updateNav(),t.nav.push({name:"",icon:"diamond",children:[]}),t._navPreview.buildNav(t.nav,!0)})),t._btnAddPage.addEventListener("click",(_=>{t.updateNav(),t.nav.push({name:"",icon:"star",url:`/${webui.uuid()}`}),t._navPreview.buildNav(t.nav,!0)}))},setNavRoutes(){this.loadNavigation()},loadNavigation(){let t=this;t._navPreview.setNavRoutes&&void 0!==webui.projectData.navigation?(t.nav=webui.clone(webui.projectData.navigation),t._navPreview.setNavRoutes(t.nav)):setTimeout((()=>t.loadNavigation()),10)},updateNav(){this.nav=function getChildNav(parent){let nav=[];return parent.childNodes.forEach((node=>{let link=node._linkData;link&&(nav.push(link),link.url||(link.children=getChildNav(node)))})),nav}(this._navPreview)},async saveNavigation(){this.updateNav(),webui.projectData.navigation=webui.clone(this.nav),await webui.proxy.saveProjectData()},connected:function(t){t.loadNavigation()},disconnected:function(t){},shadowTemplate:'\n<style type="text/css">\n:host {\ndisplay:grid;\ngrid-template-columns:max-content 1fr;\ngap:var(--padding);\n}\nslot {\ndisplay:none;\n}\nwebui-flex.form:not(.page) webui-input-text[name="url"] {\ndisplay:none;\n}\n</style>\n<webui-flex column>\n<webui-grid columns="1fr 1fr">\n<webui-button label="Cancel" theme="warning" title="Reset all nav changes"></webui-button>\n<webui-button label="Save" theme="success" title="Save all nav changes"></webui-button>\n</webui-grid>\n<app-nav-preview></app-nav-preview>\n<webui-grid columns="1fr 1fr">\n<webui-button label="Add Folder"></webui-button>\n<webui-button label="Add Page"></webui-button>\n</webui-grid>\n</webui-flex>\n<webui-flex column class="form">\n<webui-flex>\n<span class="detail"></span>\n<webui-flex grow></webui-flex>\n<webui-button label="Delete" theme="danger" title="Delete current nav item"></webui-button>\n</webui-flex>\n<webui-grid columns="2fr 3fr">\n<webui-input-text label="Name"></webui-input-text>\n<webui-input-text label="Icon" disabled></webui-input-text>\n</webui-grid>\n<webui-icon-search></webui-icon-search>\n</webui-flex>\n<slot></slot>\n'});