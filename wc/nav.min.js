"use strict";webui.define("app-nav",{preload:"fa paper nav-group nav-link",attr:["routes","nav-routes"],attrChanged:(t,property,value)=>{switch(property){case"routes":t.loadRoutes(value);break;case"navRoutes":t.buildNav(value)}},connected:t=>{t.userRole=0,t.addDataset("subscribe","session-user-role:setUserRole"),t._buildNav()},setUserRole:function(userRole){this.userRole=userRole||0,this._buildNav()},setNavRoutes:function(data){this.buildNav(data)},loadRoutes:async function(url){if(!url)return;let loaded=await fetch(url);if(!loaded.ok)return;let data=await loaded.text();this.buildNav(data)},buildLink:function(parent,link){let t=this,el=null;if(!(link.role&&link.role>0&&link.role&0===t.userRole)){if(link.url)el=document.createElement("webui-nav-link"),el.setAttribute("url",link.url);else{if(!link.children)return void console.error("Invalid nav item",link);el=document.createElement("webui-nav-group"),link.children.forEach((child=>{t.buildLink(el,child)}))}link.icon&&(el.setAttribute("icon",link.icon),link.iconFamily&&el.setAttribute("family",link.iconFamily)),el.setAttribute("name",link.name),parent.appendChild(el)}},buildNav:function(navJson){if(!navJson)return;let nav="string"==typeof navJson?JSON.parse(navJson):"function"==typeof navJson.forEach?navJson:[];this._navData=nav,this._buildNav()},_buildNav:function(){let t=this,nav=t._navData;nav&&(t.innerHTML="",nav.forEach((link=>{this.buildLink(t,link)})))}});